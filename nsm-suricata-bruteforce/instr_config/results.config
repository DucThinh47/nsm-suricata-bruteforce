#DOC: Kiem tra phien ban hien tai cua Suricata
suri-check = monitor:suricata.stdout : CONTAINS : Suricata
#DOC: Cai dat bo quy tac mac dinh cua Suricata
default-rules = monitor:ls.stdout : CONTAINS : rules
_alert_rule = monitor:head.stdout : TOKEN : 7 : STARTSWITH : alert tcp any any -> any
#DOC: Tan cong Brute-force bang Hydra
hydra-attack = attacker:.bash_history : CONTAINS : hydra -L users.txt -P passwords.txt -t 16 -f -s 22 -V ssh://172.20.0.10
#DOC: Kiem tra log alert


alert-log = monitor:/var/log/suricata/eve.json : CONTAINS : "dest_port":22
_block_rule1 = monitor:/var/lib/suricata/rules/suricata.rules : FILE_REGEX : alert tcp any any -> any 22 \(msg:".*?"; flags:S; flow:to_server; threshold:type both, track by_src, count 3, seconds 10; xbits:set,blocked_ip,track ip_src, expire 300; sid:.*; rev:1;\)
_block_rule2 = monitor:/var/lib/suricata/rules/suricata.rules : FILE_REGEX : drop tcp any any -> any 22 \(msg:".*?"; xbits:isset,blocked_ip,track ip_src; sid:.*; rev:1;\)
#DOC: Kiem tra log block

block-log = monitor:/var/log/suricata/fast.log : CONTAINS : [Drop] [**] [1:1000202:1]
